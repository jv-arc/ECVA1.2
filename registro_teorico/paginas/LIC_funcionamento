Ao tentar executar as interrupções desejadas com o GIC-400, percebeu-se que existia alta complexidade em suas ações, o que acarretava em alta latência para suas repostas, algo que não é compatível com o projeto.

Desse modo, percebemos que as interrupções terão de ser feitas pelo Local Interrupt Controler (LIC) do BCM 2836, presente no raspberry 2B que utilizamos.

Quando o LIC recebe uma interrupção, ele a avalia com base nas suas configurações de prioridade e máscara. Se a interrupção estiver habilitada e for de alta prioridade, o LIC envia um sinal ao núcleo do processador. O núcleo, ao receber esse sinal, interrompe a sua execução atual, salva o seu estado e salta para uma rotina de tratamento de interrupção (ISR - Interrupt Service Routine) para lidar com o evento.

Para que tudo isso aconteça com êxito, é necessário endereçar corretamente o que se deseja na memória. O Local Interrupt Controller do BCM2836 (fisicamente localizado em 0x40000000 na memória, de acordo com a documentação do kernel Linux) possui um conjunto de registradores mapeados. Desses, os mais relevantes para IPIs são os registradores de Mailbox.

Existem 16 mailboxes, com 4 alocados para cada um dos 4 núcleos da Raspberry Pi 2B. O Mailbox 0 é o mais comum para IPIs em sistemas como o Linux.





